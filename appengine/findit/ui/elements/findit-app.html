<link rel="import" href="/bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="/bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="/bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="/bower_components/paper-menu/paper-menu.html">
<link rel="import" href="/bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="./app-messages.html">
<link rel="import" href="./auth-login.html">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto" >

<dom-module id="findit-app">
  <template>
    <style>
      :host {
        font-family: 'Roboto', sans-serif;
      }
      app-header, paper-menu, paper-listbox {
        background-color: #4285f4;
        color: #fff;
      }
      app-header paper-menu {
        --paper-menu-selected-item: {
          font-weight: normal;
        };
      }
      app-header paper-icon-button {
        --paper-icon-button-ink-color: white;
      }
      app-header paper-item a {
        color: #fff;
        --paper-item: {
          cursor: pointer;
        };
      }
      app-header paper-item a:hover {
        color: black;
      }
    </style>

    <app-messages></app-messages>

    <app-header-layout>
      <app-header slot="header" fixed>
        <app-toolbar>
          <paper-menu>
            <paper-item><a href="/"><img src="/images/findit.png" style="width: 40px; height: 40px"/>Home</a></paper-item>
            <paper-item><a href="/waterfall/list-failures">Failures</a></paper-item>
            <paper-item><a href="/waterfall/list-flakes">Flakes</a></paper-item>
            <paper-item><a href="/waterfall/change-auto-revert-setting">AutoRevert</a></paper-item>
            <paper-item>
              <a href="https://sites.google.com/a/chromium.org/cr-culprit-finder/findit/">SitePage</a>
            </paper-item>
            <template is="dom-if" if="[[userInfo.is_admin]]">
              <paper-menu-button style="height: 18px">
                <paper-icon-button icon="menu" slot="dropdown-trigger"></paper-icon-button>
                <paper-listbox slot="dropdown-content">
                  <paper-item><a href="/waterfall/try-job-dashboard">Try-jobs</a></paper-item>
                  <br>
                  <paper-item><a href="/waterfall/pipeline-errors-dashboard">Pipeline Errors</a></paper-item>
                  <br>
                  <paper-item><a href="/waterfall/config">Config</a></paper-item>
                  <br>
                  <paper-item><a href="/waterfall/check-trybot-mapping">Trybot Mapping</a></paper-item>
                  <br>
                  <paper-item><a href="/waterfall/auto-revert-metrics">Auto Revert Metrics</a></paper-item>
                  <br>
                  <paper-item><a href="/waterfall/swarmbucket-performance">Swarmbucket Performance</a></paper-item>
                </paper-listbox>
              </paper-menu-button>
            </template>
          </paper-menu>
          <div main-title></div>
          <auth-login is-admin="[[userInfo.is_admin]]" email="[[userInfo.email]]" login-url="[[userInfo.login_url]]" logout-url="[[userInfo.logout_url]]" login-required="[[loginRequired]]"></auth-login>
        </app-toolbar>
      </app-header>
      <div id="main-content">
        <template is="dom-if" if="[[pageHeader]]">
          <h1>[[pageHeader]]</h1>
        </template>
        <slot></slot>
      <div>
    </app-header-layout>
  </template>

  <script>
   (function() {
     'use strict';

     Polymer({
       is: 'findit-app',

       properties: {
         pageHeader: {
           type: String,
           value: undefined,
         },
         loginRequired: {
           type: Boolean,
           value: false,
         },
         userInfo: {
           type: Object,
           value: undefined,
         },
       },
     });
   })();
   (function() {
     // From https://chromium.googlesource.com/infra/infra/+/master/crdx/feedback/README.md
     (function(i,s,o,g,r,a,m){i['CrDXObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','https://storage.googleapis.com/crdx-feedback.appspot.com/feedback.js','crdx');

     var comment = encodeURIComponent('Page URL: ' + window.location.href + '\n\n Description:\n');
     crdx('setFeedbackButtonLink', 'https://bugs.chromium.org/p/chromium/issues/entry?labels=Pri-2&status=Unconfirmed&components=Tools>Test>FindIt&comment=' + comment);
   })();
  </script>
</dom-module>
